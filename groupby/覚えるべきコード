âœ… è¦šãˆã¦ãŠãã¹ãã‚³ãƒ¼ãƒ‰ 3ã¤
â‘  ã‚°ãƒ«ãƒ¼ãƒ—é›†è¨ˆï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼‰

ã‚«ãƒ†ã‚´ãƒªã‚„ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã”ã¨ã®åˆè¨ˆã‚’å‡ºã™ã¨ãã®åŸºæœ¬å½¢ã§ã™ã€‚

# ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥ã®ä¸è‰¯æ•°ãƒ©ãƒ³ã‚­ãƒ³ã‚°
supplier_counts = (
    df.groupby("ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼")["ä¸è‰¯æ•°"]
      .sum()
      .sort_values(ascending=False)
)
print(supplier_counts)


ğŸ‘‰ groupby + sum() + sort_values() ã®çµ„ã¿åˆã‚ã›ã¯ é‰„æ¿ã€‚

â‘¡ æœˆã”ã¨ã®æ¨ç§»ï¼ˆã‚¯ãƒ­ã‚¹é›†è¨ˆï¼‰

æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«åºƒã’ã¦åˆ†æã™ã‚‹å½¢ã€‚

# æœˆåˆ¥ Ã— ä¸è‰¯ã‚«ãƒ†ã‚´ãƒªã®æ¨ç§»
monthly_trend = (
    df.groupby(["å¹´æœˆ", "ä¸è‰¯ã‚«ãƒ†ã‚´ãƒª"])["ä¸è‰¯æ•°"]
      .sum()
      .unstack()
      .fillna(0)
)
print(monthly_trend)


ğŸ‘‰ unstack() ã§ã€Œãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«é¢¨ã€ã«ãªã‚‹ã®ã‚’è¦šãˆã‚‹ã¨å¼·åŠ›ã€‚

â‘¢ Excelå‡ºåŠ› + ã‚°ãƒ©ãƒ•åŸ‹ã‚è¾¼ã¿

çµæœã‚’Excelã«æ›¸ãå‡ºã—ã¦ã€å ±å‘Šç”¨ã«ã¾ã¨ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã€‚

output_file = "ãƒ¬ãƒãƒ¼ãƒˆ.xlsx"
with pd.ExcelWriter(output_file, engine="xlsxwriter") as writer:
    # é›†è¨ˆè¡¨ã‚’æ›¸ãè¾¼ã¿
    supplier_counts.to_excel(writer, sheet_name="ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥é›†è¨ˆ")

    # ã‚°ãƒ©ãƒ•ã‚’ä½œæˆ
    workbook  = writer.book
    sheet = writer.sheets["ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥é›†è¨ˆ"]
    chart = workbook.add_chart({"type": "column"})
    chart.add_series({
        "categories": ["ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥é›†è¨ˆ", 2, 0, len(supplier_counts)+1, 0],
        "values":     ["ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥é›†è¨ˆ", 2, 1, len(supplier_counts)+1, 1],
    })
    chart.set_title({"name": "ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥ ä¸è‰¯æ•°"})
    sheet.insert_chart("D2", chart)


ğŸ‘‰ with pd.ExcelWriter(..., engine="xlsxwriter") ã®ä¸­ã§ã‚„ã‚‹ã®ãŒãƒã‚¤ãƒ³ãƒˆã€‚

ğŸ’¡ ã¾ã¨ã‚

groupbyé›†è¨ˆï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°å‡ºã™åŸºæœ¬ï¼‰

unstackã§ã‚¯ãƒ­ã‚¹é›†è¨ˆï¼ˆæœˆåˆ¥æ¨ç§»ãªã©ï¼‰

ExcelWriter + ã‚°ãƒ©ãƒ•ï¼ˆãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ï¼‰

ã“ã®3ã¤ã‚’ãƒã‚¹ã‚¿ãƒ¼ã™ã‚Œã°ã€ã ã„ãŸã„ã®ã€Œå·¥å ´ãƒ‡ãƒ¼ã‚¿åˆ†æâ†’ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã€ãƒ•ãƒ­ãƒ¼ã¯å›ã›ã¾ã™ ğŸ’ª
