# Excel 照合スクリプト

このリポジトリは、**材料確認品目.xlsx（単品/品目(Ver無)）** と **ASSYBOM.xlsx（部品No.）** を照合し、
- 材料側に `assemblyフラグ`、ASSYBOM側に `材料フラグ` を付与
- 照合サマリー＋ユニオン一覧を作成

する Python スクリプトを含みます。

## ファイル
- [check_parts.py](./check_parts.py) … 実行スクリプト本体（←GitHubでも相対リンクで開けます）

## 使い方
1. このフォルダに `材料確認品目.xlsx` と `ASSYBOM.xlsx` を置く（材料は **単品** シートを使用）。
2. 必要なら `check_parts.py` 冒頭の設定（列名/シート名/出力名）を調整。
3. 実行：

```bash
pip install pandas openpyxl xlsxwriter   # 必要に応じて
python check_parts.py
```

生成物：`材料ASSYBOM_照合_3出力.xlsx`（3シート）  
- `1_材料(単品)+assemblyフラグ` … 材料元データ＋ASSYBOM存在フラグ  
- `2_ASSYBOM+材料フラグ` … ASSYBOM元データ＋材料存在フラグ  
- `3_照合結果` … サマリーとユニオン（両方/片側のみ）

## 仕様ハイライト
- **正規化照合**：全角→半角、空白削除、ダッシュ統一（― — － ー → `-`）、英字は大文字化
- **ヘッダー自動検出**：指定列名を含む行をヘッダーに採用（帳票上部に説明行があってもOK）
- **列名ゆらぎ耐性**：全角/半角・空白・大小の揺れに強い一致で列を特定
