
# ğŸ“ pandasã§æ¤œæŸ»å…·ãƒªã‚¹ãƒˆã‹ã‚‰åˆè¨ˆå·¥æ•°ã‚’ç®—å‡ºã™ã‚‹

## ç›®çš„
- éƒ¨å“ã”ã¨ã®æ¤œæŸ»å…·ãƒªã‚¹ãƒˆã‚’ã‚‚ã¨ã«ã€**æ¨™æº–å·¥æ•°ã®åˆè¨ˆ**ã‚’æ±‚ã‚ã‚‹  
- ã€Œorã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å¹³å‡ã‚’æ¡ç”¨ã™ã‚‹  
- æœ€çµ‚çµæœã‚’ Excel ã«å‡ºåŠ›ã™ã‚‹  

---

## ã‚³ãƒ¼ãƒ‰ä¾‹
```python
import pandas as pd
import ast

# === ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ ===
df_tools = pd.read_excel("tools_list_by_part.xlsx")   # æ¤œæŸ»å…·ãƒªã‚¹ãƒˆ
df_kosu  = pd.read_excel("src/æ¤œæŸ»å·¥æ•°.xlsx")         # æ¨™æº–å·¥æ•°è¡¨

# æ¨™æº–å·¥æ•°è¾æ›¸ã‚’ä½œæˆ
kosu_dict = df_kosu.set_index("è¨˜å·")["æ¨™æº–å·¥æ•°"].to_dict()

results = []
for _, row in df_tools.iterrows():
    plan_no = row["æ¤œæŸ»è¨ˆç”»æ›¸å“ç•ª"]
    tools_list_str = row["æ¤œæŸ»å…·ãƒªã‚¹ãƒˆ"]

    if pd.isna(tools_list_str):
        total_time = 0
    else:
        tools_list = ast.literal_eval(tools_list_str)
        total_time = 0
        for tool in tools_list:
            if "or" in tool:  # é¸æŠè‚¢ãƒ‘ã‚¿ãƒ¼ãƒ³
                options = [opt.strip() for opt in tool.split("or")]
                std_times = [float(kosu_dict[o]) for o in options if o in kosu_dict and pd.notna(kosu_dict[o])]
                if std_times:
                    total_time += sum(std_times) / len(std_times)  # å¹³å‡
            else:
                if tool in kosu_dict and pd.notna(kosu_dict[tool]):
                    total_time += float(kosu_dict[tool])

    results.append({"æ¤œæŸ»è¨ˆç”»æ›¸å“ç•ª": plan_no, "åˆè¨ˆæ¨™æº–å·¥æ•°": total_time})

# === å‡ºåŠ› ===
df_result = pd.DataFrame(results)
df_result.to_excel("æ¤œæŸ»è¨ˆç”»æ›¸å“ç•ª_åˆè¨ˆæ¨™æº–å·¥æ•°.xlsx", index=False)
```

---

## ãƒã‚¤ãƒ³ãƒˆ
- **è¾æ›¸åŒ– (`to_dict`)** ã§å·¥æ•°è¡¨ã‚’é«˜é€Ÿå‚ç…§ã§ãã‚‹  
- **"or"** â†’ å¹³å‡ã‚’å–ã‚‹ãƒ«ãƒ¼ãƒ«  
- æ¬ æï¼ˆNaNï¼‰ã¯ **0 ã¨ã¿ãªã™**  

---

## è¿½åŠ Tips
### â± å·¥æ•°ï¼ˆHH:MM:SSï¼‰ã‚’ç§’ã«å¤‰æ›
```python
df['å·¥æ•°ï¼ˆç§’ï¼‰'] = pd.to_timedelta(df['å·¥æ•°']).dt.total_seconds()
```

### ğŸ”— éƒ¨å“ç•ªå·ï¼‹Ver.åˆ—ã‚’é€£çµ
```python
df['Ver.'] = df['Ver.'].astype(str).str.replace('_','').str.replace(' ','')
df['å“ç›®ã‚³ãƒ¼ãƒ‰'] = df['éƒ¨å“ç•ªå·'].astype(str) + df['Ver.']
```

---

## ã¾ã¨ã‚
- æ¤œæŸ»å…·ãƒªã‚¹ãƒˆã¨å·¥æ•°è¡¨ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€**éƒ¨å“ã”ã¨ã®åˆè¨ˆå·¥æ•°**ã‚’ç®—å‡ºã§ãã‚‹  
- å·¥æ•°ã®é›†è¨ˆãƒ«ãƒ¼ãƒ«ï¼ˆå¹³å‡ãƒ»åˆè¨ˆãƒ»æœ€å¤§ãªã©ï¼‰ã¯æ¥­å‹™è¦ä»¶ã«å¿œã˜ã¦å¤‰æ›´å¯èƒ½  
- å‡ºåŠ›å½¢å¼ã¯ Excel ãªã®ã§ã€ç¤¾å†…å…±æœ‰ã‚‚å®¹æ˜“  
