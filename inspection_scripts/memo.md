# 受入れ検査品リスト不要カラム削除ツール

このメモは、`受入れ検査品リスト.xlsx` から不要なカラムを削除する Python スクリプトとその使い方を記録しています。ソースコードは [`clean_columns.py`](clean_columns.py) に保管してあり、このファイルではその概要と実行手順について説明します。

## ツールの概要

- **対象ファイル**: 受入れ検査品リスト.xlsx（複数シートを想定）
- **削除リスト**: カラム名一覧.xlsx の先頭列に並んだ不要カラム名
- **処理内容**:
  1. 削除リストから削除候補を読み込み、全角・半角、スペース、大文字小文字のゆらぎを正規化して突き合わせます。
  2. 受入れ検査品リスト.xlsx の各シートを読み込み、該当するカラムを削除します。
  3. 削除後のファイルと、削除されたカラム・未検出のカラムをまとめたレポートを出力します。

## 実行方法

```
python clean_columns.py \
  --input_file 受入れ検査品リスト.xlsx \
  --drop_list カラム名一覧.xlsx \
  --output_file 受入れ検査品リスト_trimmed.xlsx \
  --report_file 削除レポート.xlsx
```

- `input_file` には元の Excel ファイルを指定します。
- `drop_list` には削除したいカラム名を並べた Excel ファイルを指定します。
- `output_file` には削除後の Excel ファイルが出力されます。
- `report_file` にはシートごとの削除サマリーや削除されたカラム、未検出カラムの一覧が含まれます。

## コードのポイント

ソースコードでは、カラム名のゆらぎを抑えるために以下の正規化を行っています。

- `unicodedata.normalize("NFKC")` で全角・半角や記号を統一
- `strip()` で前後のスペースを除去
- `lower()` で英字の大文字・小文字を無視

また、削除対象が複数シートに存在する場合も一括で処理し、削除レポートに各シートの結果をまとめています。必要に応じてホワイトリストやシートごとの条件分岐を追加することで、さらに柔軟な運用が可能です。

---

このメモと [`clean_columns.py`](clean_columns.py) を同一リポジトリに置くことで、将来不要カラム削除処理が必要になった際にすぐに利用できます。
