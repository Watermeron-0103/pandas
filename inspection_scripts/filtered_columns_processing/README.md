# 受入れ検査品 不要列フィルタリング備忘録

このフォルダは、受入れ検査品リストから不要なカラムを削除したり、
参照に無いカラムだけを抽出したりするための備忘録です。実際の処理は
`filtered_columns_script.py` で実行し、その結果として 2 種類の Excel ファイル
を生成します。

## ファイル一覧

| ファイル名 | 内容 |
|---|---|
|`pattern1_受入れ検査品_参照に一致する列を削除.xlsx`|参照リストに含まれるカラム名と一致する列を削除した結果。|
|`pattern2_受入れ検査品_参照に無い列だけ.xlsx`|参照リストに含まれない列のみを残した結果。pattern1 と同じ列集合だが名称で区别。|
|`filtered_columns_script.py`|処理を実行する Python スクリプト。NFKC 正規化により全角/ 半角・空白・英大小の振るぎを吸収してカラム名を突合します。|
|このメモ (README)|備忘録として概要・使い方を記述。|

## 使い方

1. このフォルダに `受入れ検査品.xlsx` と `filtered_columns.xlsx` を置きます。
2. Python 環境で `python filtered_columns_script.py` を実行します。
3. `filtered_columns.xlsx` の最初の非空列に並んだカラム名を参照して一致判定を行い、
   - *パターン1*: 一致する列を削除した結果 (`pattern1_...`)
   - *パターン2*: 一致しない列だけを抽出した結果 (`pattern2_...`)

   を出力します。

## メモ

- カラム名の比較は NFKC 正規化後に前後の空白を除去し、大文小文字を無視して行います。
- パターン1とパターン2は実質同じ列セットですが、用途に従って名称を分けています。
- カラム名リストに空行や重複が含まれていても自動的にスキップされます。

`filtered_columns_script.py` の実装は [こちら](filtered_columns_script.py) を参照してください。
