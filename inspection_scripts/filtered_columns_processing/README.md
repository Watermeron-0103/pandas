# 受入れ検査品 不要列フィルタリング備忘録

このフォルダは、受入れ検査品リストから不要なカラムを削除したり、参照に無いカラムだけを抽出したりするための備忘録です。実際の処理は各 Python スクリプトで実行し、その結果として 2 種類の Excel ファイルを生成します。

## 実務上の推奨

パターン1（参照リストに含まれる列を削除する方法）を実務では推奨します。これは「不要な列を指定して取り除く」方式のため、何を削除したのかが明確でレビューしやすく、元データの列順も保たれます。参照リストを「残したい列」に切り替えたい場合は、`mode` 引数を `keep` に設定することでホワイトリスト方式に切り替えることもできます。

## ファイル一覧

| ファイル名 | 内容 |
| --- | --- |
| `pattern1_filter.py` | 参照リストに含まれるカラム名と一致する列を削除し、元データのその他の列だけを保存するスクリプトです。 |
| `pattern2_filter.py` | 参照リストに存在しないカラムのみを抽出して保存するスクリプトです。結果は `pattern1` と同じ列集合ですが、スクリプトとして区別しています。 |
| `filtered_columns_script.py` | 両方のパターンを1本で実行する従来のスクリプト。用途に応じて使い分けてください。 |
| このREADME | 本フォルダの概要・使い方、及びパターン1が推奨である旨をまとめています。 |

## 使い方

1. このフォルダに `受入れ検査品リスト.xlsx` と `filtered_columns.xlsx` を置きます。
2. Python 環境で使用したいスクリプトを実行します。
   - `pattern1_filter.py` を実行すると、参照リストに含まれる列を取り除いた Excel ファイルが出力されます。
   - `pattern2_filter.py` を実行すると、参照リストに含まれない列のみを抽出した Excel ファイルが出力されます。
3. 各スクリプトはカレントディレクトリに結果ファイルを生成します。ファイル名には `pattern1_` または `pattern2_` で始まるプレフィックスが付与されます。

## メモ

- カラム名の比較は NFKC 正規化後に前後の空白を除去し、大文字・小文字を無視して行います。
- パターン1とパターン2は出力される列集合自体は同じですが、「削除方式」と「抽出方式」という違いから、実務上はパターン1が推奨されます。
- 参照リストに空行や重複が含まれていても自動的にスキップされます。