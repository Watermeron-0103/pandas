# ① 覚えておくべきコード

## 1. グループ集計（ランキング）
```python
supplier_counts = (
    df.groupby("サプライヤー")["不良数"]
      .sum()
      .sort_values(ascending=False)
)
print(supplier_counts)
👉 groupby + sum() + sort_values() は鉄板

2. 月ごとの推移（クロス集計）
python
コードをコピーする
monthly_trend = (
    df.groupby(["年月", "不良カテゴリ"])["不良数"]
      .sum()
      .unstack()
      .fillna(0)
)
print(monthly_trend)
👉 unstack() でピボットテーブル風

3. Excel出力 + グラフ埋め込み
python
コードをコピーする
output_file = "レポート.xlsx"
with pd.ExcelWriter(output_file, engine="xlsxwriter") as writer:
    supplier_counts.to_excel(writer, sheet_name="サプライヤー別集計")
    workbook  = writer.book
    sheet = writer.sheets["サプライヤー別集計"]
    chart = workbook.add_chart({"type": "column"})
    chart.add_series({
        "categories": ["サプライヤー別集計", 2, 0, len(supplier_counts)+1, 0],
        "values":     ["サプライヤー別集計", 2, 1, len(supplier_counts)+1, 1],
    })
    chart.set_title({"name": "サプライヤー別 不良数"})
    sheet.insert_chart("D2", chart)
👉 with pd.ExcelWriter(..., engine="xlsxwriter") の中で処理するのがポイント

② README風（GitHub公開用 そのまま使える）
工場データ分析の基本コード集
覚えておくべきコード 3つ
① グループ集計（ランキング）
カテゴリやサプライヤーごとの不良数を合計してランキング表示する基本パターン。

python
コードをコピーする
supplier_counts = (
    df.groupby("サプライヤー")["不良数"]
      .sum()
      .sort_values(ascending=False)
)
print(supplier_counts)
② 月ごとの推移（クロス集計）
年月 × 不良カテゴリ をクロス集計し、月ごとの推移を一目で見られる形に。

python
コードをコピーする
monthly_trend = (
    df.groupby(["年月", "不良カテゴリ"])["不良数"]
      .sum()
      .unstack()
      .fillna(0)
)
print(monthly_trend)
③ Excel出力 + グラフ埋め込み
集計結果をExcelに書き出し、グラフ付きでレポート化。

python
コードをコピーする
output_file = "レポート.xlsx"
with pd.ExcelWriter(output_file, engine="xlsxwriter") as writer:
    supplier_counts.to_excel(writer, sheet_name="サプライヤー別集計")

    workbook  = writer.book
    sheet = writer.sheets["サプライヤー別集計"]

    chart = workbook.add_chart({"type": "column"})
    chart.add_series({
        "categories": ["サプライヤー別集計", 2, 0, len(supplier_counts)+1, 0],
        "values":     ["サプライヤー別集計", 2, 1, len(supplier_counts)+1, 1],
    })
    chart.set_title({"name": "サプライヤー別 不良数"})
    sheet.insert_chart("D2", chart)
まとめ
コードパターン	用途
groupby().sum().sort_values()	ランキング集計（カテゴリ別・サプライヤー別など）
groupby().sum().unstack()	クロス集計（ピボット風）で時系列分析
ExcelWriter + グラフ埋め込み	Excelレポートを自動生成
